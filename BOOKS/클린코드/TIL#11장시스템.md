# 📝 TIL (2022.03.13)  
📖 오늘 읽은 범위 : 11장. 시스템
--- 
> 😄 **책에서 기억하고 싶은 내용을 써보세요.**  
- ### 시스템 수준에서도 깨끗함을 유지하는 방법
- #### 시스템 제작과 시스템 사용을 분리하라
  - 제작(construction)과 사용(user)는 아주 다르다.
  - 소프트웨어 시스템은 (애플리케이션 객체를 제작하고 의존성을 서로 '연결'하는) 준비 과정과 (준비 과정 이후에 이어지는) 런타임 로직을 분리해야 한다.
  - ##### 관심사 분리(시작단계)
    - 런타임 로직과 마구 뒤섞인 준비 과정 코드
    ```java
      public Service getService() {
        if (service == null)
          service = new MyServiceImpl(...);
         return service;
      }
    ```
    - 초기화 지연(Lazy Initialization) 혹은 계산 지연(Lazy Evaluation) 기법으로 구현한 예시 코드. 
    - 체계적이고 탄탄한 시스템을 만들고 싶다면 흔히 쓰는 좀스럽고 손쉬운 기법으로 모듈성을 깨서는 절대로 안 된다. 객체를 생성하거나 의존성을 연결할 때도 마찬가지다. 설정 논리는 일반 실행 논리와 분리해야 모듈성이 높아진다.  
또한 주요 의존성을 해소하기 위한 방식, 즉 전반적이며 일관적인 방식도 필요하다.
- ##### Main 분리
  - 시스템 생성과 시스템 사용을 분리하는 한 가지 방법.
  - 생성과 관련한 코드는 모두 main이나 main이 호출하는 모듈로 옮기고, 나머지 시스템은 모든 객체가 생성되었고 모든 의존성이 연결되었다고 가정한다.
- ##### 팩토리
  - 객체가 생성되는 시점을 애플리케이션에서 결정.
- ##### 의존성 주입
  - 제어 역전(Inversion of Control, IoC) 기법을 의존성 관리에 적용한 메커니즘
  - 클래스가 의존성을 해결하려 시도하지 않는다. 클래스는 완전히 수동적이다. 대신에 의존성을 주입하는 방법으로 설정자(setter) 메서드나 생성자 인수를 제공한다.
  - DI 컨테이너는 (대개 요청이 들어올 때마다) 필요한 객체의 인스턴스를 만든 후 생성자 인수나 설정자 메서드를 사용해 의존성을 설정한다. 실제로 생성되는 객체 유형은 설정 파일에서 지정하거나 특수 생성 모듈에서 코드로 명시한다.
  - 대다수 DI 컨테이너는 필요할 때까지는 객체를 생성하지 않고, 대부분은 계산 지연이나 비슷한 최적화에 쓸 수 있도록 팩토리를 호출하거나 프록시를 생성하는 방법을 제공한다. 즉, 계산 지연 기법이나 이와 유사한 최적화 기법에서 이런 메커니즘을 사용할 수 있다.
- #### 확장
  - '처음부터 올바르게' 시스템을 만들 수 있다는 믿음은 미신이다. 대신에 우리는 오늘 주어진 사용자 스토리에 맞춰 시스템을 구현해야 한다. 내일은 새로운 스토리에 맞춰 시스템을 조정하고 확장하면 된다. 이것이 반복적이고 점진적인 애자일 방식의 핵심이다.
  - 테스트 주도 개발(Test-drived Development, TDD), 리팩터링, (TDD와 리팩터링으로 얻어지는) 깨끗한 코드는 코드 수준에서 시스템을 조정하고 확장하기 쉽게 만든다.
  - 소프트웨어 시스템은 물리적인 시스템과 다르다. 관심사를 적절히 분리해 관리한다면 소프트웨어 아키텍처는 점진적으로 발전할 수 있다.
- #### 횡단(cross-cutting) 관심사
  - 영속성 프레임워크 모듈화
  - 관점 지향 프로그래밍(Aspect-Oriented Programming, AOP) - 횡단 관심사에 대처에 모듈성을 확보하는 일반적인 방법론
- #### 테스트 주도 시스템 아키텍처 구축
  - 코드 수준에서 아키텍처 관심사를 분리할 수 있다면, 진정한 테스트 주도 아키텍처 구축이 가능해진다.
  - 최선의 시스템 구조는 각기 POJO(또는 다른) 객체로 구현되는 모듈화된 관심사 영역(도메인)으로 구성된다. 이렇게 서로 다른 영역은 해당 영역 코드에 최소한의 영향을 미치는 관점이나 유사한 도구를 사용해 통합한다.
이런 구조 역시 코드와 마찬가지로 테스트 주도 기법을 적용할 수 있다.
- #### 의사 결정을 최적화하라
  - 가능한 마지막 순간까지 결정을 미루는 방법이 최선이라는 사실을 까먹곤 한다.
  - 너무 일찍 결정하면 고객 피드백을 더 모으고, 프로젝트를 더 고민하고, 구현 방안을 더 탐험할 기회가 사라진다.
- #### 시스템은 도메인 특화 언어가 필요하다.
  - 간단한 스크립트 언어나 표준 언어로 구현한 API.
  - 도메인 특화 언어를 사용하면 고차원 정책에서 저차원 세부 사항에 이르기까지 모든 추상화 수준과 모든 도메인을 POJO로 표현할 수 있다.
- #### 결론
  - 모든 추상화 단계에서 의도는 명확히 표현해야 한다. 그러려면 POJO를 작성하고 관점 혹은 관점과 유사한 메커니즘을 사용해 각 구현 관심사를 분리해야 한다.
  - 시스템을 설계하든 개별 모듈을 설계하든, 실제로 돌아가는 가장 단순한 수단을 사용해야 한다.

> 🤔 **오늘 읽은 소감은? 떠오르는 생각을 가볍게 적어보세요**  

사실.. 많은 깨달음을 얻지 못한 것 같다. 그래도 기록해두고 다시 봐둬야 겠다.
책을 읽으면서 대부분 경험을 기반으로 대입하여 읽었었는데 이 장부턴 그게 조금 어려울 것 같기도 하다.


> 🔎 **궁금한 내용이 있거나, 잘 이해되지 않는 내용이 있다면 적어보세요.**  
- 초기화 지연(Lazy Initialization) 혹은 계산 지연(Lazy Evaluation) 기법 -  계산의 결과값이 필요할 때까지 계산을 늦추는 기법
- BDUF(Big Design Up Front) - 구현을 시작하기 전에 앞으로 벌어질 모든 사항을 설계하는 기법

> 오늘 TIL 3줄 요약
- 소프트웨어 시스템은 (애플리케이션 객체를 제작하고 의존성을 서로 '연결'하는) 준비 과정과 (준비 과정 이후에 이어지는) 런타임 로직을 분리해야 한다.
- 관심사를 적절히 분리해 관리한다면 소프트웨어 아키텍처는 점진적으로 발전할 수 있다.
- 시스템은 도메인 특화 언어가 필요하다.

> 오늘 읽은 다른사람의 TIL
https://velog.io/@ann0905/%ED%81%B4%EB%A6%B0%EC%BD%94%EB%93%9C-%EC%99%84%EB%8F%85%EC%8A%A4%ED%84%B0%EB%94%94-TIL-2022.02.15
